directorio<-"C:\\Users\\Androide1\\Documents\\Mathias\\Maestría\\Tópicos de Distribución del Ingreso\\Trabajo Empirico"
setwd(directorio)
load("premincer.RData")
library(ineq)
library(ggplot2)
library(dummies)
####VERSION COMPATIBILIZADA EN ANCHO DE LAS BASES####
base.91<-base.91[,c("dpto","peso2","principal","lnwh","edu2","mujer","interior","exppot","exppot2","fulltime","edu20","edu21","edu22","edu23","edu24","edu25","edu26","edu27","edu28","edu29","edu210","edu211","edu212","edu213","edu214","edu215","edu216","edu217","edu218","edu219","edu220","rama1","rama2","rama3","rama4","rama5","rama6","rama7","rama8")]
base.92<-base.92[,c("dpto","peso2","principal","lnwh","edu2","mujer","interior","exppot","exppot2","fulltime","edu20","edu21","edu22","edu23","edu24","edu25","edu26","edu27","edu28","edu29","edu210","edu211","edu212","edu213","edu214","edu215","edu216","edu217","edu218","edu219","edu220","rama1","rama2","rama3","rama4","rama5","rama6","rama7","rama8")]
base.93<-base.93[,c("dpto","peso2","principal","lnwh","edu2","mujer","interior","exppot","exppot2","fulltime","edu20","edu21","edu22","edu23","edu24","edu25","edu26","edu27","edu28","edu29","edu210","edu211","edu212","edu213","edu214","edu215","edu216","edu217","edu218","edu219","edu220","rama1","rama2","rama3","rama4","rama5","rama6","rama7","rama8")]
base.94<-base.94[,c("dpto","peso2","principal","lnwh","edu2","mujer","interior","exppot","exppot2","fulltime","edu20","edu21","edu22","edu23","edu24","edu25","edu26","edu27","edu28","edu29","edu210","edu211","edu212","edu213","edu214","edu215","edu216","edu217","edu218","edu219","edu220","rama1","rama2","rama3","rama4","rama5","rama6","rama7","rama8")]
base.95<-base.95[,c("dpto","peso2","principal","lnwh","edu2","mujer","interior","exppot","exppot2","fulltime","edu20","edu21","edu22","edu23","edu24","edu25","edu26","edu27","edu28","edu29","edu210","edu211","edu212","edu213","edu214","edu215","edu216","edu217","edu218","edu219","edu220","rama1","rama2","rama3","rama4","rama5","rama6","rama7","rama8")]
base.96<-base.96[,c("dpto","peso2","principal","lnwh","edu2","mujer","interior","exppot","exppot2","fulltime","edu20","edu21","edu22","edu23","edu24","edu25","edu26","edu27","edu28","edu29","edu210","edu211","edu212","edu213","edu214","edu215","edu216","edu217","edu218","edu219","edu220","rama1","rama2","rama3","rama4","rama5","rama6","rama7","rama8")]
base.97<-base.97[,c("dpto","peso2","principal","lnwh","edu2","mujer","interior","exppot","exppot2","fulltime","edu20","edu21","edu22","edu23","edu24","edu25","edu26","edu27","edu28","edu29","edu210","edu211","edu212","edu213","edu214","edu215","edu216","edu217","edu218","edu219","edu220","rama1","rama2","rama3","rama4","rama5","rama6","rama7","rama8")]
base.98<-base.98[,c("dpto","peso2","principal","lnwh","edu2","mujer","interior","exppot","exppot2","fulltime","edu20","edu21","edu22","edu23","edu24","edu25","edu26","edu27","edu28","edu29","edu210","edu211","edu212","edu213","edu214","edu215","edu216","edu217","edu218","edu219","edu220","rama1","rama2","rama3","rama4","rama5","rama6","rama7","rama8")]
base.99<-base.99[,c("dpto","peso2","principal","lnwh","edu2","mujer","interior","exppot","exppot2","fulltime","edu20","edu21","edu22","edu23","edu24","edu25","edu26","edu27","edu28","edu29","edu210","edu211","edu212","edu213","edu214","edu215","edu216","edu217","edu218","edu219","edu220","rama1","rama2","rama3","rama4","rama5","rama6","rama7","rama8")]
base.0<-base.0[,c("dpto","peso2","principal","lnwh","edu2","mujer","interior","exppot","exppot2","fulltime","edu20","edu21","edu22","edu23","edu24","edu25","edu26","edu27","edu28","edu29","edu210","edu211","edu212","edu213","edu214","edu215","edu216","edu217","edu218","edu219","edu220","rama1","rama2","rama3","rama4","rama5","rama6","rama7","rama8")]
base.1<-base.1[,c("dpto","peso2","principal","lnwh","edu2","mujer","interior","exppot","exppot2","fulltime","edu20","edu21","edu22","edu23","edu24","edu25","edu26","edu27","edu28","edu29","edu210","edu211","edu212","edu213","edu214","edu215","edu216","edu217","edu218","edu219","edu220","rama1","rama2","rama3","rama4","rama5","rama6","rama7","rama8")]
base.2<-base.2[,c("dpto","peso2","principal","lnwh","edu2","mujer","interior","exppot","exppot2","fulltime","edu20","edu21","edu22","edu23","edu24","edu25","edu26","edu27","edu28","edu29","edu210","edu211","edu212","edu213","edu214","edu215","edu216","edu217","edu218","edu219","edu220","rama1","rama2","rama3","rama4","rama5","rama6","rama7","rama8")]
base.3<-base.3[,c("dpto","peso2","principal","lnwh","edu2","mujer","interior","exppot","exppot2","fulltime","edu20","edu21","edu22","edu23","edu24","edu25","edu26","edu27","edu28","edu29","edu210","edu211","edu212","edu213","edu214","edu215","edu216","edu217","edu218","edu219","edu220","rama1","rama2","rama3","rama4","rama5","rama6","rama7","rama8")]
base.4<-base.4[,c("dpto","peso2","principal","lnwh","edu2","mujer","interior","exppot","exppot2","fulltime","edu20","edu21","edu22","edu23","edu24","edu25","edu26","edu27","edu28","edu29","edu210","edu211","edu212","edu213","edu214","edu215","edu216","edu217","edu218","edu219","edu220","rama1","rama2","rama3","rama4","rama5","rama6","rama7","rama8")]
base.5<-base.5[,c("dpto","peso2","principal","lnwh","edu2","mujer","interior","exppot","exppot2","fulltime","edu20","edu21","edu22","edu23","edu24","edu25","edu26","edu27","edu28","edu29","edu210","edu211","edu212","edu213","edu214","edu215","edu216","edu217","edu218","edu219","edu220","rama1","rama2","rama3","rama4","rama5","rama6","rama7","rama8")]
base.6<-base.6[,c("dpto","peso2","principal","lnwh","edu2","mujer","interior","exppot","exppot2","fulltime","edu20","edu21","edu22","edu23","edu24","edu25","edu26","edu27","edu28","edu29","edu210","edu211","edu212","edu213","edu214","edu215","edu216","edu217","edu218","edu219","edu220","rama1","rama2","rama3","rama4","rama5","rama6","rama7","rama8")]
base.7<-base.7[,c("dpto","peso2","principal","lnwh","edu2","mujer","interior","exppot","exppot2","fulltime","edu20","edu21","edu22","edu23","edu24","edu25","edu26","edu27","edu28","edu29","edu210","edu211","edu212","edu213","edu214","edu215","edu216","edu217","edu218","edu219","edu220","rama1","rama2","rama3","rama4","rama5","rama6","rama7","rama8")]
base.8$principal<-base.8$principal_sf
base.8<-base.8[,c("dpto","peso2","principal","lnwh","edu2","mujer","interior","exppot","exppot2","fulltime","edu20","edu21","edu22","edu23","edu24","edu25","edu26","edu27","edu28","edu29","edu210","edu211","edu212","edu213","edu214","edu215","edu216","edu217","edu218","edu219","edu220","rama1","rama2","rama3","rama4","rama5","rama6","rama7","rama8")]
base.9$principal<-base.9$principal_sf
base.9<-base.9[,c("dpto","peso2","principal","lnwh","edu2","mujer","interior","exppot","exppot2","fulltime","edu20","edu21","edu22","edu23","edu24","edu25","edu26","edu27","edu28","edu29","edu210","edu211","edu212","edu213","edu214","edu215","edu216","edu217","edu218","edu219","edu220","rama1","rama2","rama3","rama4","rama5","rama6","rama7","rama8")]
base.10$principal<-base.10$principal_sf
base.10<-base.10[,c("dpto","peso2","principal","lnwh","edu2","mujer","interior","exppot","exppot2","fulltime","edu20","edu21","edu22","edu23","edu24","edu25","edu26","edu27","edu28","edu29","edu210","edu211","edu212","edu213","edu214","edu215","edu216","edu217","edu218","edu219","edu220","rama1","rama2","rama3","rama4","rama5","rama6","rama7","rama8")]
base.11$principal<-base.11$principal_sf
base.11<-base.11[,c("dpto","peso2","principal","lnwh","edu2","mujer","interior","exppot","exppot2","fulltime","edu20","edu21","edu22","edu23","edu24","edu25","edu26","edu27","edu28","edu29","edu210","edu211","edu212","edu213","edu214","edu215","edu216","edu217","edu218","edu219","edu220","rama1","rama2","rama3","rama4","rama5","rama6","rama7","rama8")]
base.12$principal<-base.12$principal_sf
base.12<-base.12[,c("dpto","peso2","principal","lnwh","edu2","mujer","interior","exppot","exppot2","fulltime","edu20","edu21","edu22","edu23","edu24","edu25","edu26","edu27","edu28","edu29","edu210","edu211","edu212","edu213","edu214","edu215","edu216","edu217","edu218","edu219","edu220","rama1","rama2","rama3","rama4","rama5","rama6","rama7","rama8")]
base.13$principal<-base.13$principal_sf
base.13<-base.13[,c("dpto","peso2","principal","lnwh","edu2","mujer","interior","exppot","exppot2","fulltime","edu20","edu21","edu22","edu23","edu24","edu25","edu26","edu27","edu28","edu29","edu210","edu211","edu212","edu213","edu214","edu215","edu216","edu217","edu218","edu219","edu220","rama1","rama2","rama3","rama4","rama5","rama6","rama7","rama8")]
base.14$principal<-base.14$principal_sf
base.14<-base.14[,c("dpto","peso2","principal","lnwh","edu2","mujer","interior","exppot","exppot2","fulltime","edu20","edu21","edu22","edu23","edu24","edu25","edu26","edu27","edu28","edu29","edu210","edu211","edu212","edu213","edu214","edu215","edu216","edu217","edu218","edu219","edu220","rama1","rama2","rama3","rama4","rama5","rama6","rama7","rama8")]
############BASE UNIFICADA################
base.t<-rbind(base.91,base.92,base.93,base.94,base.95,base.96,base.97,base.98,base.99,base.0,base.1,base.2,base.3,base.4,base.5,base.6,base.7,base.8,base.9,base.10,base.11,base.12,base.13,base.14)
base.t$anio<-c(rep(1991,nrow(base.91)),rep(1992,nrow(base.92)),rep(1993,nrow(base.93)),rep(1994,nrow(base.94)),rep(1995,nrow(base.95)),rep(1996,nrow(base.96)),rep(1997,nrow(base.97)),rep(1998,nrow(base.98)),rep(1999,nrow(base.99)),rep(2000,nrow(base.0)),rep(2001,nrow(base.1)),rep(2002,nrow(base.2)),rep(2003,nrow(base.3)),rep(2004,nrow(base.4)),rep(2005,nrow(base.5)),rep(2006,nrow(base.6)),rep(2007,nrow(base.7)),rep(2008,nrow(base.8)),rep(2009,nrow(base.9)),rep(2010,nrow(base.10)),rep(2011,nrow(base.11)),rep(2012,nrow(base.12)),rep(2013,nrow(base.13)),rep(2014,nrow(base.14)))
rm(list=c("base.91","base.92","base.93","base.94","base.95","base.96","base.97","base.98","base.99","base.0","base.1","base.2","base.3","base.4","base.5","base.6","base.7","base.8","base.9","base.10","base.11","base.12","base.13","base.14"))
ramas<-function(x){
  ifelse(x==1,"Agropecuaria y minería",ifelse(x==2,"Industrias manufactureras",ifelse(x==3,"Electricidad, Gas y Agua",ifelse(x==4,"Construcción",ifelse(x==5,"Comercio, Restaurantes y Hoteles",ifelse(x==6,"Transportes y Comunicaciones",ifelse(x==7,"Servicios a Empresas",ifelse(x==8,"Servicios comunales, sociales y personales"))))))))
}
############ESTIMACIONES DE RETORNOS######
form.mincer1<-formula(lnwh~mujer+interior+exppot+exppot2+edu21+edu22+edu23+edu24+edu25+edu26+edu27+edu28+edu29+edu210+edu211+edu212+edu213+edu214+edu215+edu216+edu217+edu218+edu219+edu220+fulltime+rama1+rama2+rama3+rama4+rama5+rama6+rama7)
lista.retornos<-list()
for(i in 1991:2014){
lista.retornos[[i]]<-summary(lm(form.mincer1,base.t[which(base.t$anio==i),],weights=base.t[which(base.t$anio==i),"peso2"]))$coefficients[c("edu21","edu22","edu23","edu24","edu25","edu26","edu27","edu28","edu29","edu210","edu211","edu212","edu213","edu214","edu215","edu216","edu217","edu218","edu219","edu220"),]
}

mod1991<-lm(form.mincer1,base.t[which(base.t$anio==1991),],weights=base.t[which(base.t$anio==1991),"peso2"])
mod1999<-lm(form.mincer1,base.t[which(base.t$anio==1999),],weights=base.t[which(base.t$anio==1999),"peso2"])
mod2007<-lm(form.mincer1,base.t[which(base.t$anio==2007),],weights=base.t[which(base.t$anio==2007),"peso2"])
mod2014<-lm(form.mincer1,base.t[which(base.t$anio==2014),],weights=base.t[which(base.t$anio==2014),"peso2"])
